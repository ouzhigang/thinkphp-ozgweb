webpackJsonp([10],{q562:function(t,e){},sdT7:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("KKrt"),n={data:function(){return{id:1e3,maindata:[],editTitle:"",editVisible:!1,delVisible:!1,defaultProps:{children:"children",label:"name"},to_delete_id:0,mainform:{id:0,name:"",parent_id:0,sort:0,type:0},validform:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}},methods:{loadData:function(){this.maindata.length=0;var t=this;t.mainform.type=a.b.get_rest_param("type"),t.$axios.get(a.a.web_server_root+"data_class/show?type="+t.mainform.type).then(function(e){0==e.data.code?t.maindata=e.data.data:t.$alert(error,"提示",{confirmButtonText:"确定",type:"error"})}).catch(function(e){t.$alert(e,"提示",{confirmButtonText:"确定",type:"error"})})},handleAdd:function(){this.editTitle="添加顶级分类",this.mainform.id=0,this.mainform.name="",this.mainform.sort=0,this.mainform.parent_id=0,this.editVisible=!0},append:function(t){this.editTitle=t.name+" - 添加子分类",this.mainform.id=0,this.mainform.name="",this.mainform.sort=0,this.mainform.parent_id=t.id,this.editVisible=!0},edit:function(t,e){this.editTitle="编辑分类",this.mainform.id=e.id,this.mainform.name=e.name,this.mainform.sort=e.sort,this.mainform.parent_id=e.parent_id,this.editVisible=!0},remove:function(t,e){this.to_delete_id=e.id,this.delVisible=!0},saveEdit:function(){this.editVisible=!1;var t=this;t.$refs.mainform.validate(function(e){if(!e)return t.$alert("请正确输入完整信息","提示",{confirmButtonText:"确定",type:"error"}),!1;var i={name:t.mainform.name,sort:t.mainform.sort,parent_id:t.mainform.parent_id,type:t.mainform.type};0!=t.mainform.id&&(i.id=t.mainform.id),t.$axios.post(a.a.web_server_root+"data_class/add",i).then(function(e){0==e.data.code?(t.mainform.id=0,t.mainform.name="",t.mainform.sort=0,t.mainform.parent_id=0,t.loadData(),t.$message({message:e.data.msg,type:"success"})):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){t.$alert(e,"提示",{confirmButtonText:"确定",type:"error"})})})},deleteRow:function(){var t=this,e=a.a.web_server_root+"data_class/del?id="+t.to_delete_id;t.$axios.get(e).then(function(e){t.delVisible=!1,0==e.data.code?(t.loadData(),t.$message({message:e.data.msg,type:"success"})):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){t.$alert(e,"提示",{confirmButtonText:"确定",type:"error"})})}},mounted:function(){this.loadData()},watch:{$route:function(t,e){this.loadData()}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-lx-cascades"}),t._v(" 产品分类")]),t._v(" "),i("el-breadcrumb-item",[t._v("分类列表")])],1),t._v(" "),i("div",{staticClass:"btn-right"},[i("el-button",{attrs:{icon:"el-icon-plus",circle:""},on:{click:t.handleAdd}})],1)],1),t._v(" "),i("div",{staticClass:"container"},[i("el-tree",{attrs:{data:t.maindata,props:t.defaultProps,"node-key":"id","expand-on-click-node":!1,"default-expand-all":""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node,n=e.data;return i("span",{staticClass:"custom-tree-node"},[i("span",[t._v(t._s(a.label))]),t._v(" "),i("span",[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return t.append(n)}}},[t._v("添加子节点")]),t._v(" "),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return t.edit(a,n)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return t.remove(a,n)}}},[t._v("删除")])],1)])}}])})],1),t._v(" "),i("el-dialog",{attrs:{title:t.editTitle,visible:t.editVisible,width:"50%"},on:{"update:visible":function(e){t.editVisible=e}}},[i("el-form",{ref:"mainform",attrs:{model:t.mainform,rules:t.validform,"label-width":"90px"}},[i("el-form-item",{attrs:{label:"名称",prop:"name"}},[i("el-input",{model:{value:t.mainform.name,callback:function(e){t.$set(t.mainform,"name",e)},expression:"mainform.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"排序"}},[i("el-input-number",{model:{value:t.mainform.sort,callback:function(e){t.$set(t.mainform,"sort",e)},expression:"mainform.sort"}})],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.editVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.saveEdit}},[t._v("确 定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"提示",visible:t.delVisible,width:"300px",center:""},on:{"update:visible":function(e){t.delVisible=e}}},[i("div",{staticClass:"del-dialog-cnt"},[t._v("删除不可恢复，是否确定删除？")]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.delVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.deleteRow}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var o=i("C7Lr")(n,r,!1,function(t){i("q562")},"data-v-1087e566",null);e.default=o.exports}});