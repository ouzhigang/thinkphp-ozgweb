webpackJsonp([7],{BfnU:function(e,t){},jgEq:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("KKrt"),n={name:"user_show",data:function(){return{maindata:[],page:1,page_count:1,page_size:1,total:1,selected_objs:[],editTitle:"",editVisible:!1,delVisible:!1,doMany:!1,mainform:{name:"",pwd:""},validform:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}]},idx:-1}},mounted:function(){this.loadData()},methods:{handleCurrentChange:function(e){this.page=e,this.loadData()},loadData:function(){this.maindata.length=0;var e=this;e.$axios.get(i.a.web_server_root+"user/show?page="+e.page).then(function(t){e.maindata=t.data.data.list,e.page=t.data.data.page,e.page_count=t.data.data.page_count,e.page_size=t.data.data.page_size,e.total=t.data.data.total}).catch(function(t){e.$alert(t,"提示",{confirmButtonText:"确定",type:"error"})})},handleAdd:function(){this.editTitle="添加用户",this.editVisible=!0},handleEdit:function(e,t){this.idx=e;this.maindata[e];this.editTitle="编辑用户",this.doMany=!1,this.editVisible=!0},handleDelete:function(e,t){this.idx=e,this.doMany=!1,this.delVisible=!0},handleSelectionChange:function(e){this.selected_objs=e},saveEdit:function(){this.editVisible=!1;var e=this;e.$refs.mainform.validate(function(t){if(!t)return e.$alert("请正确输入完整信息","提示",{confirmButtonText:"确定",type:"error"}),!1;e.$axios.post(i.a.web_server_root+"user/add",{name:e.mainform.name,pwd:e.mainform.pwd}).then(function(t){0==t.data.code?(e.mainform.name="",e.mainform.pwd="",e.page=1,e.loadData(),e.$message({message:t.data.msg,type:"success"})):e.$message({message:t.data.msg,type:"error"})}).catch(function(t){e.$alert(t,"提示",{confirmButtonText:"确定",type:"error"})})})},deleteRow:function(){var e=this,t=null;if(e.doMany){if(0==e.selected_objs.length)return e.$message({message:"请选择要删除的用户",type:"error"}),this.delVisible=!1,!1;t=i.a.web_server_root+"user/del?ids=";for(var a=0;a<e.selected_objs.length;a++)t+=e.selected_objs[a].id,a+1<e.selected_objs.length&&(t+=",")}else t=i.a.web_server_root+"user/del?ids="+e.maindata[e.idx].id;e.$axios.get(t).then(function(t){if(e.delVisible=!1,0==t.data.code){if(e.doMany){for(var a=0;a<e.selected_objs.length;a++)for(var i=0;i<e.maindata.length;i++)e.selected_objs[a].id==e.maindata[i].id&&e.maindata.splice(i,1);e.selected_objs.length=0}else e.maindata.splice(e.idx,1);e.$message({message:t.data.msg,type:"success"})}else e.$message({message:t.data.msg,type:"error"})}).catch(function(t){e.$alert(t,"提示",{confirmButtonText:"确定",type:"error"})})},handleDeleteMany:function(){this.doMany=!0,this.delVisible=!0}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 用户管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("用户列表")])],1),e._v(" "),a("div",{staticClass:"btn-right"},[a("el-button",{attrs:{icon:"el-icon-plus",circle:""},on:{click:e.handleAdd}})],1)],1),e._v(" "),a("div",{staticClass:"container"},[a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.maindata,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"用户名",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"add_time_s",label:"添加时间",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"err_login",label:"错误登录次数",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-count":e.page_count},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("div",{staticClass:"many"},[a("el-button",{attrs:{type:"danger",plain:""},on:{click:e.handleDeleteMany}},[e._v("删除")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.editTitle,visible:e.editVisible,width:"50%"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"mainform",attrs:{model:e.mainform,rules:e.validform,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"name"}},[a("el-input",{model:{value:e.mainform.name,callback:function(t){e.$set(e.mainform,"name",t)},expression:"mainform.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[a("el-input",{model:{value:e.mainform.pwd,callback:function(t){e.$set(e.mainform,"pwd",t)},expression:"mainform.pwd"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.delVisible,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteRow}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var l=a("C7Lr")(n,s,!1,function(e){a("BfnU")},"data-v-70ed9e56",null);t.default=l.exports}});